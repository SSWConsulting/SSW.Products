---
seo:
  title: SSW EagleEye - Secret Management for App Registrations
  description: >-
    Rotate expired or expiring client secrets for EagleEye Engine and Portal app
    registrations, then update matching Key Vault secret values.
title: Manage Secrets for App Registrations
date: '2026-02-25T00:00:00.000Z'
---

Use this guide when a client secret for the `Engine` or `Portal` app registration is expiring (or has expired), and you need to rotate it safely.

This guide is intended for SysAdmins or anyone with basic Azure knowledge.

Secret rotation is currently a manual Azure process. In future EagleEye releases, secret management will be available directly in the EagleEye Portal.

## Required roles and permissions

> **Tip:** You do not need to hold all roles yourself. If needed, ask your SysAdmin or IT admin to perform these steps or grant the required access.

For app registration secret creation or deletion, you typically need one of:

* App registration **[Owner](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/delegate-app-roles#assign-application-owners)**
* **[Application Administrator](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#application-administrator)**

For Key Vault secret value updates:

* **[Key Vault Secrets Officer](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/security#key-vault-secrets-officer)** (recommended least privilege, if using [Azure RBAC](https://learn.microsoft.com/en-us/azure/role-based-access-control/overview))
* **[Key Vault Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/security#key-vault-administrator)** (broader access)
* **[Assign a Key Vault access policy (legacy)](https://learn.microsoft.com/en-us/azure/key-vault/general/assign-access-policy?tabs=azure-portal):**
  * The older permission model allowing you to assign explicit, granular permissions (like `Get`, `List`, `Set`, `Delete`) directly to a [security principal](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-principals).
  * Microsoft currently recommends migrating from this to Azure RBAC when possible.

## Using Azure Portal
### Step 1. Rotate the App Registration Secret

1. Confirm which app secret you are rotating (`Engine` or `Portal`).
2. In **Azure Portal**, go to **App registrations** → **All applications** and search `SSW.EagleEye`.
3. Open the target app (no secret management required for the Api app):
   * `SSW.EagleEye.Engine`
   * `SSW.EagleEye.Portal`

   ![](/EagleEye/Guides/3-App-Registrations.png)
4. Go to **Manage → Certificates & secrets**.
5. Click **New client secret**, set a clear description (for example, `EngineSecret-Updated-YYYY-MM-DD`), choose expiry, then click **Add**.
   * **Recommended:** create the new secret first, verify, then delete the old one.

   ![](/EagleEye/Guides/Update-Engine-Secret.png)
6. **Copy the secret value immediately** (it is shown only once).
   ![](/EagleEye/Guides/Copy-Engine-Secret.png)

> **Tip:** Keep the new secret in temporary notes until Key Vault is updated, then delete from the temporary notes immediately.

For more info on these app registrations and the Master app flow, see [App Registrations & Permissions](./app-registrations-reference).

### Step 2. Update the secret value in your EagleEye Key Vault

1. In your **Azure Portal →** **Resource groups** **→** Select **EagleEye resource group** which you created during installation.
2. Open the EagleEye managed application project.
   ![](/EagleEye/Guides/EagleEye-RG.png)
3. Open the **Managed resource group** (named `mrg-ssweagleeye-xxx`).
   ![](/EagleEye/Guides/EagleEye-MRG.png)
4. Search for `kv-shared` in your **Managed Resource Group** & click on the Key Vault (named `kv-shared-xxx`).
   ![](/EagleEye/Guides/KV-Shared.png)
5. Go to **Secrets** and open the matching secret name (based on which app you rotated):
   * `SSW.EagleEye.Engine` → `AppRegistration-ClientSecret`
   * `SSW.EagleEye.Portal` → `AppRegistration-ClientSecret-Portal`

   ![](/EagleEye/Guides/KV-Secrets.png)
6. Create a new secret version with the copied client secret value.

   ![](/EagleEye/Guides/KV-Secret-New.png)![](/EagleEye/Guides/KV-Secret-New-Paste.png)
7. Right click on previous secret version & disable it
8. Confirm only new version is enabled
   ![](/EagleEye/Guides/KV-Secrets-Enabled-Disabled.png)

### Step 3. Restart the App (only for Portal)

* If you rotated the **Portal** app secret, we need to restart the Portal container app (`ca-nextjs-xxx`) so it picks up the new value.

To restart:

1. Find your portal container app in your managed resource group (same way you found the Key Vault `kv-shared-xxx` in step 2 above)
2. Open the Portal container app (`ca-nextjs-xxx`).
   ![](/EagleEye/Guides/CA-Nextjs-xxx.png)
3. Select **Stop**, then **Start**.![](/EagleEye/Guides/CA-Stop.png)

### Step 4. Verify

* Confirm the new app secret exists and is not expired.
* Confirm Key Vault shows the new latest secret version.
* Confirm the old Key Vault secret version is disabled.
* For Portal: You can logout & confirm you can log back in
* For Engine: Run a manual scan & confirm engine is working
* After validation, remove the old app registration client secret if still present.

## Using Azure CLI (optional)

> Use CLI only if you are comfortable handling secrets in terminal history.
>\
> Recommended: run these commands in [Azure Cloud Shell](https://shell.azure.com).

### Step 1. Get App ID by display name

> **Important:** Run the full sequence of steps for one app before starting the other. 
>\
> The commands use shared variables (`$APP_ID`, `$NEW_SECRET`, etc.) that will be overwritten if you try to do both at the same time.

For `Engine`:
```bash
APP_NAME="SSW.EagleEye.Engine"
```

Or for `Portal`:
```bash
APP_NAME="SSW.EagleEye.Portal"
```

Then run:

```bash
APP_ID=$(az ad app list --display-name "$APP_NAME" --query "[0].appId" -o tsv)
echo "App ID for $APP_NAME: $APP_ID"
```


### Step 2. Add a new client secret (append, do not replace existing)

You can set duration using `--years` 

```bash
NEW_SECRET=$(az ad app credential reset \
  --id "$APP_ID" \
  --append \
  --display-name "${APP_NAME}-$(date +%Y-%m-%d)" \
  --years 1 \
  --query password -o tsv)
```

or for 6 months use `--end-date` (syntax differs by OS):



**Linux / Azure Cloud Shell:**

```bash
END_DATE=$(date -u -d "+6 months" +"%Y-%m-%d")

NEW_SECRET=$(az ad app credential reset \
  --id "$APP_ID" \
  --append \
  --display-name "${APP_NAME}-$(date +%Y-%m-%d)" \
  --end-date "$END_DATE" \
  --query password -o tsv)
```

**macOS:**

```bash
END_DATE=$(date -v+6m +"%Y-%m-%d")

NEW_SECRET=$(az ad app credential reset \
  --id "$APP_ID" \
  --append \
  --display-name "${APP_NAME}-$(date +%Y-%m-%d)" \
  --end-date "$END_DATE" \
  --query password -o tsv)
```
### Step 3. Find the EagleEye Key Vault and update the secret value

#### Key Vault name
- Find your EagleEye managed Key Vault name using **Azure Portal | Step 2 (1-4)** above, 
- Or do a global search in your Azure portal for the term `kv-shared`.
If you have multiple search results, make sure to select the one inside the EagleEye managed resource group.

Set the name in the variable (replace with yours e.g., `kv-shared-4thm4hks76hci`):

```bash
KV_NAME="kv-shared-xxx"
```

#### New secret value
For Engine:

```bash
KV_SECRET_NAME="AppRegistration-ClientSecret"

az keyvault secret set \
  --vault-name "$KV_NAME" \
  --name "$KV_SECRET_NAME" \
  --value "$NEW_SECRET"
```

Or for Portal:

```bash
KV_SECRET_NAME="AppRegistration-ClientSecret-Portal"

az keyvault secret set \
  --vault-name "$KV_NAME" \
  --name "$KV_SECRET_NAME" \
  --value "$NEW_SECRET"
```

### Step 4. Disable old Key Vault secret version

List all versions sorted newest first.

```bash
echo "Listing versions for $KV_NAME/$KV_SECRET_NAME..."
az keyvault secret list-versions \
  --vault-name "$KV_NAME" \
  --name "$KV_SECRET_NAME" \
  --query "reverse(sort_by([], &attributes.created))[].{Created:attributes.created, Enabled:attributes.enabled, Version:id}" \
  -o table
```

The output will look similar to this. The **first row is always the current (newest) version**.
Any other rows that are still `Enabled: True` are old versions that should be disabled:

```bash
Listing versions for kv-shared-4thm4hks76hci/AppRegistration-ClientSecret...
Created                    Enabled    Version
-------------------------  ---------  ----------------------------------------------------------------
2026-02-26T00:25:28+00:00  True       https://.../AppRegistration-ClientSecret/1028af169d254426a63efe # [!code ++]
2026-02-25T03:46:07+00:00  True       https://.../AppRegistration-ClientSecret/a75206c31c29485fbe507d # [!code --]
2026-02-10T05:15:05+00:00  False      https://.../AppRegistration-ClientSecret/9a049207d6754f2fb6588b
```

Copy the **GUID at the end** of the `Version` URL for the old enabled row(s) e.g., `a75206c31c29485fbe507d53c2210bac`.

Set it as a variable:

```bash
OLD_VERSION_ID="<old-version-guid>"
```

Then disable it:

```bash
az keyvault secret set-attributes \
  --vault-name "$KV_NAME" \
  --name "$KV_SECRET_NAME" \
  --version "$OLD_VERSION_ID" \
  --enabled false
```

### Step 5. Delete old app credential after verification

List all credentials sorted by creation date, newest first:

```bash
echo "Listing credentials for $APP_NAME (App ID: $APP_ID)..."
az ad app credential list \
  --id "$APP_ID" \
  --query "reverse(sort_by([], &startDateTime))[].{Description:displayName, Created:startDateTime, Expires:endDateTime, KeyId:keyId}" \
  -o table
```

The output will look similar to this — the **first row is the new secret** you just created. Copy the `KeyId` of the old one(s):

```bash
Listing credentials for SSW.EagleEye.Engine (App ID: 39336800-358b-4650-ab57-12236c1ff8b3)...
Description                         Created                    Expires                    KeyId
----------------------------------  -------------------------  -------------------------  ------------------------------------
SSW.EagleEye.Engine-2026-02-26      2026-02-26T00:25:28+00:00  2027-02-26T00:25:28+00:00  aabbccdd-1234-5678-abcd-111122223333 # [!code ++]
SSW.EagleEye.Engine-2026-02-25      2026-02-25T03:46:07+00:00  2027-02-25T03:46:07+00:00  eeff0011-aaaa-bbbb-cccc-444455556666 # [!code --]
```

Set the old key ID:

```bash
OLD_KEY_ID="<old-key-id-guid>"
```

Then delete it:

```bash
az ad app credential delete --id "$APP_ID" --key-id "$OLD_KEY_ID"
```
Then you can run the list command again to confirm only the new secret remains.

### Step 6. Optional: restart Portal container app (if Portal secret changed)

> **Tip:** It is easier to restart from the Azure Portal — follow **Using Azure Portal → Step 3** above.
>\
> The Azure CLI is bit flaky to restart the container app


## Notes

* Rotate secrets before they expire where possible.
* Do not delete and recreate app registrations for standard secret rotation.
